query GetCustomerOverview($companyId: uuid!, $loanType: loan_type_enum) {
  companies_by_pk(id: $companyId) {
    id
    financial_summaries(order_by: { date: desc }, limit: 1) {
      id
      ...FinancialSummary
    }
    outstanding_loans: loans(
      where: {
        _and: [
          { loan_type: { _eq: $loanType } }
          { funded_at: { _is_null: false } }
          { rejected_at: { _is_null: true } }
          { closed_at: { _is_null: true } }
        ]
      }
    ) {
      id
      ...LoanLimited
      line_of_credit {
        id
        ...LineOfCredit
      }
      purchase_order {
        id
        order_number
      }
    }
    pending_payments: payments(
      where: {
        _and: [
          { type: { _eq: "repayment" } }
          { submitted_at: { _is_null: false } }
          { settled_at: { _is_null: true } }
        ]
      }
    ) {
      id
      ...PaymentLimited
    }
  }
}

query GetCustomerForBank($id: uuid!) {
  companies_by_pk(id: $id) {
    id
    ...CustomerForBank
    contract {
      id
      product_type
    }
  }
}

query BankCustomerListVendorPartnerships($companyId: uuid!) {
  company_vendor_partnerships(where: { company_id: { _eq: $companyId } }) {
    ...BankVendorPartnership
    vendor {
      id
      ...Vendor
      users {
        id
        ...Contact
      }
    }
    vendor_bank_account {
      id
      verified_at
    }
  }
}

query BankCustomerListPayorPartnerships($companyId: uuid!) {
  company_payor_partnerships(where: { company_id: { _eq: $companyId } }) {
    ...PayorPartnership
    payor {
      id
      ...Payor
      users {
        id
        ...Contact
      }
    }
  }
}
