query GetActiveLoansForCompany($companyId: uuid!, $loanType: loan_type_enum!) {
  companies_by_pk(id: $companyId) {
    id
    financial_summary {
      id
      ...FinancialSummary
    }
    loans(
      where: {
        _and: [
          { closed_at: { _is_null: true } }
          { loan_type: { _eq: $loanType } }
        ]
      }
    ) {
      id
      ...LoanLimited
      line_of_credit {
        id
        ...LineOfCredit
      }
      purchase_order {
        id
        order_number
      }
    }
  }
}

query GetNotFundedLoansForBank {
  loans(where: { funded_at: { _is_null: true } }) {
    id
    ...Loan
    company {
      id
      name
    }
    line_of_credit {
      id
      ...LineOfCredit
    }
    purchase_order {
      id
      order_number
      vendor {
        id
        name
      }
    }
  }
}

query GetFundedLoansForBank {
  loans(where: { funded_at: { _is_null: false } }) {
    id
    ...Loan
    company {
      id
      name
    }
    line_of_credit {
      id
      ...LineOfCredit
    }
    purchase_order {
      id
      order_number
      vendor {
        id
        name
      }
    }
  }
}

query GetClosedLoansForCompany($companyId: uuid!, $loanType: loan_type_enum!) {
  companies_by_pk(id: $companyId) {
    id
    financial_summary {
      id
      ...FinancialSummary
    }
    loans(
      where: {
        _and: [
          { closed_at: { _is_null: false } }
          { loan_type: { _eq: $loanType } }
        ]
      }
    ) {
      id
      ...LoanLimited
      line_of_credit {
        id
        ...LineOfCredit
      }
      purchase_order {
        id
        order_number
      }
    }
  }
}

query LoanSiblings(
  $loanId: uuid!
  $loanType: loan_type_enum!
  $artifactId: uuid!
) {
  loans(
    where: {
      _and: [
        { id: { _neq: $loanId } }
        { loan_type: { _eq: $loanType } }
        { artifact_id: { _eq: $artifactId } }
      ]
    }
  ) {
    id
    loan_type
    artifact_id
    amount
    status
  }
}

query LoansByCompanyAndLoanTypeForCustomer(
  $companyId: uuid!
  $loanType: loan_type_enum!
) {
  loans(
    where: {
      _and: [
        { company_id: { _eq: $companyId } }
        { loan_type: { _eq: $loanType } }
      ]
    }
  ) {
    ...LoanLimited
    line_of_credit {
      id
      ...LineOfCredit
    }
    purchase_order {
      id
      order_number
    }
  }
}

query GetOutstandingLoansForCustomer(
  $companyId: uuid!
  $loanType: loan_type_enum!
) {
  loans(
    where: {
      _and: [
        { company_id: { _eq: $companyId } }
        { status: { _in: [funded, past_due] } }
        { loan_type: { _eq: $loanType } }
      ]
    }
  ) {
    ...LoanLimited
    line_of_credit {
      id
      ...LineOfCredit
    }
    purchase_order {
      id
      order_number
    }
  }
}

query LoansByCompanyAndLoanTypeForBank(
  $companyId: uuid!
  $loanType: loan_type_enum!
) {
  loans(
    where: {
      _and: [
        { company_id: { _eq: $companyId } }
        { loan_type: { _eq: $loanType } }
      ]
    }
  ) {
    id
    ...Loan
    line_of_credit {
      id
      ...LineOfCredit
    }
    purchase_order {
      id
      order_number
    }
  }
}

query LoansForBank {
  loans {
    id
    ...Loan
    company {
      id
      name
    }
    line_of_credit {
      id
      ...LineOfCredit
    }
    purchase_order {
      id
      order_number
      vendor {
        id
        name
      }
    }
  }
}

query LoansByStatusesForBank($statuses: [loan_status_enum!]!) {
  loans(where: { status: { _in: $statuses } }) {
    id
    ...Loan
    company {
      id
      name
    }
    line_of_credit {
      id
      ...LineOfCredit
    }
    purchase_order {
      id
      order_number
      vendor {
        id
        name
      }
    }
  }
}

query GetLoansByLoanIds($loanIds: [uuid!]) {
  loans(where: { id: { _in: $loanIds } }) {
    id
    ...Loan
  }
}
