subscription GetOpenLoansByDebtFacilityStatuses($statuses: [String!]) {
  loans ( where: {
    _and: [
      { loan_report: { debt_facility_status: { _in: $statuses } } },
      {
        _or: [
          { is_deleted: { _is_null: true } },
          { is_deleted: { _eq: false } }
        ]
      },
      { closed_at: { _is_null: true } }
    ]
  }) {
    id
    ...Loan
    loan_report {
      id
      ...LoanReport
    }
    company {
      id
      ...CompanyLimited
    }
    purchase_order {
      id
      vendor {
        id
        name
      }
    }
  }
}

subscription GetDebtFacilityCapacity {
  debt_facility_capacities (
    order_by: [{ changed_at: desc }]
  ) {
    id
    ...DebtFacilityCapacityLimited
    debt_facility {
      id
      ...DebtFacilityLimited
    }
  }
}

subscription GetDebtFacilities {
  debt_facilities (
    order_by: [{ name: desc }]
  ) {
    id
    ...DebtFacilityLimited
    debt_facility_capacities {
      id
      ...DebtFacilityCapacityLimited
    }
  }
}
