query GetCompanyForCustomerOverview($companyId: uuid!) {
  companies_by_pk(id: $companyId) {
    id
    contract {
      id
      product_type
      product_config
    }
    loans(
      where: {
        _and: [
          { funded_at: { _is_null: false } }
          { closed_at: { _is_null: true } }
        ]
      }
    ) {
      ...LoanLimited
    }
  }
}

# Query is used to determine what navigation options to show in sidebar.
query CompanyWithDetailsByCompanyId($companyId: uuid!) {
  companies_by_pk(id: $companyId) {
    id
    contract {
      id
      ...Contract
    }
  }
}

mutation GetCompanyNextLoanIdentifier(
  $companyId: uuid!
  $increment: companies_inc_input!
) {
  update_companies_by_pk(pk_columns: { id: $companyId }, _inc: $increment) {
    id
    latest_loan_identifier
  }
}
