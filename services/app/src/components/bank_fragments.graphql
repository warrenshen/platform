#
# This file is for fragments used by users on the Bank side
#   - Generally speaking, the bank can query nearly all fields

## Users

fragment Contact on users {
  id
  company_id
  full_name
  first_name
  last_name
  email
  phone_number
  created_at
}

fragment CompanyPayorContact on company_payor_contacts {
  id
  payor_user_id
  user {
    id
    ...Contact
  }
}

fragment CompanyVendorContact on company_vendor_contacts {
  id
  vendor_user_id
  user {
    id
    ...Contact
  }
}

## Companies

fragment CustomerForBank on companies {
  id
  identifier
  name
  contract_name
  employer_identification_number
  dba_name
  address
  country
  state
  city
  zip_code
  phone_number
}

fragment CompanySettings on company_settings {
  id
  advances_bespoke_bank_account_id
  collections_bespoke_bank_account_id
  two_factor_message_method
  is_dummy_account
  ...CompanySettingsLimited
}

# Bank accounts can be stored for the Bespoke bank and for customers
fragment BankAccount on bank_accounts {
  id
  torrey_pines_template_name
  ...BankAccountLimited
}

fragment MetrcApiKey on metrc_api_keys {
  id
  created_at
  last_used_at
  is_functioning
  status_codes_payload
}

## Purchase Order Financing

fragment Vendor on vendors {
  id
  address
  country
  state
  city
  zip_code
  phone_number
  ...VendorLimited
}

fragment PurchaseOrder on purchase_orders {
  id
  bank_note
  ...PurchaseOrderLimited
}

fragment Loan on loans {
  id
  loan_report_id
  notes
  ...LoanLimited
}

fragment LoanReport on loan_reports {
  id
  repayment_date
  total_principal_paid
  total_interest_paid
  total_fees_paid
  financing_period
  financing_day_limit
}

fragment LoanArtifact on loans {
  id
  invoice {
    id
    ...Invoice
  }
  line_of_credit {
    id
    ...LineOfCredit
  }
  purchase_order {
    id
    ...PurchaseOrder
  }
  ...LoanArtifactLimited
}

## Invoices
fragment Payor on payors {
  id
  address
  country
  state
  city
  zip_code
  phone_number
  ...PayorLimited
}

fragment PartnershipRequest on company_partnership_requests {
  id
  requesting_company_id
  two_factor_message_method
  company_type
  company_name
  license_info
  is_cannabis
  user_info
  created_at
  requested_by_user_id
  settled_by_user_id
  settled_at
}

fragment VendorPartnership on company_vendor_partnerships {
  id
  vendor_bank_id
  vendor_bank_account {
    id
    verified_at
  }
  ...VendorPartnershipLimited
}

fragment PayorPartnership on company_payor_partnerships {
  id
  ...PayorPartnershipLimited
}

## Finance

fragment Payment on payments {
  id
  bank_note
  created_at
  ...PaymentLimited
}

fragment PaymentBankAccounts on payments {
  id
  company_bank_account {
    ...BankAccount
  }
  recipient_bank_account {
    ...BankAccount
  }
}

fragment Transaction on transactions {
  id
  created_at
  loan_id
  payment_id
  type
  subtype
  amount
  effective_date
  to_principal
  to_interest
  to_fees
}

fragment BankFinancialSummary on bank_financial_summaries {
  id
  updated_at
  date
  product_type
  adjusted_total_limit
  total_outstanding_principal
  total_outstanding_interest
  total_outstanding_fees
  total_principal_in_requested_state
  available_limit
  interest_accrued_today
}
