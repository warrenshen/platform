query GetBankPayorPartnership($id: uuid!) {
  company_payor_partnerships_by_pk(id: $id) {
    ...PayorPartnership
    payor {
      ...ThirdParty
      settings {
        id
        collections_bespoke_bank_account {
          ...BankAccount
        }
      }
      users {
        ...Contact
      }
    }
    company {
      ...Company
      users {
        ...Contact
      }
      settings {
        ...CompanySettings
      }
    }
    payor_agreement {
      ...CompanyAgreement
    }
    payor_license {
      ...CompanyLicense
    }
  }
}

query GetPayorPartnershipsForBank {
  company_payor_partnerships(order_by: { payor: { name: asc } }) {
    ...PayorPartnership
    company {
      id
      name
    }
    payor {
      ...ThirdParty
      settings {
        id
      }
      users {
        ...Contact
      }
    }
  }
}

mutation UpdateCompanyPayorPartnershipApprovedAt(
  $companyPayorPartnershipId: uuid!
  $approvedAt: timestamptz
) {
  update_company_payor_partnerships_by_pk(
    pk_columns: { id: $companyPayorPartnershipId }
    _set: { approved_at: $approvedAt }
  ) {
    ...PayorPartnership
  }
}

mutation UpdatePayorInfo($id: uuid!, $company: companies_set_input!) {
  update_companies_by_pk(pk_columns: { id: $id }, _set: $company) {
    ...ThirdParty
  }
}

mutation UpdatePayorAgreementId(
  $companyPayorPartnershipId: uuid!
  $payorAgreementId: uuid
) {
  update_company_payor_partnerships_by_pk(
    pk_columns: { id: $companyPayorPartnershipId }
    _set: { payor_agreement_id: $payorAgreementId }
  ) {
    id
    payor_agreement {
      ...CompanyAgreement
    }
  }
}

mutation AddCompanyPayorAgreement(
  $payorAgreement: company_agreements_insert_input!
) {
  insert_company_agreements_one(object: $payorAgreement) {
    ...CompanyAgreement
  }
}

## License mutations

mutation UpdatePayorLicenseId(
  $companyPayorPartnershipId: uuid!
  $payorLicenseId: uuid!
) {
  update_company_payor_partnerships_by_pk(
    pk_columns: { id: $companyPayorPartnershipId }
    _set: { payor_license_id: $payorLicenseId }
  ) {
    id
    payor_license {
      ...CompanyLicense
    }
  }
}

mutation AddCompanyPayorLicense($payorLicense: company_licenses_insert_input!) {
  insert_company_licenses_one(object: $payorLicense) {
    ...CompanyLicense
  }
}
